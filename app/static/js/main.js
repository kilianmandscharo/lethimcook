"use strict";(()=>{var a=(t,n)=>()=>(n||t((n={exports:{}}).exports,n),n.exports);var E=a(g=>{"use strict";Object.defineProperty(g,"__esModule",{value:!0});g.attachMutationObserverToNotificationContainer=N;g.notify=T;function N(){let t=document.getElementById("notification-container");if(!t)return;new MutationObserver((e,o)=>{for(let i of e)i.type==="childList"&&i.addedNodes.forEach(r=>{setTimeout(()=>{t.removeChild(r)},3e3)})}).observe(t,{childList:!0})}function T(t,n){let e=document.getElementById("notification-container");if(!e)return;let i=document.querySelectorAll(".notification").length,r=document.createElement("div");r.id=`notification-${i}`,r.className=n==="success"?"notification notification-success":"notification notification-danger";let c=document.createElement("div");c.className=n==="success"?"fa-solid fa-circle-info":"fa-regular fa-circle-exclamation";let s=document.createElement("p");s.className="notification-text",s.innerText=t,r.appendChild(c),r.appendChild(s),e.appendChild(r)}});var S=a(p=>{"use strict";Object.defineProperty(p,"__esModule",{value:!0});p.SelectDialog=void 0;var P=C(),v=class t{static injectLinkIntoTextarea(n,e){let{cursorPos:o,target:i,substitutionStart:r}=t.state;if(!o||!i||!r)return;let c=`[${n}](${window.location.origin}/recipe/${e})`,s=o+c.length;i.value=i.value.slice(0,r)+c+i.value.slice(t.state.cursorPos),i.selectionStart=i.selectionEnd=s-(o-r),t.state={}}static close(){var n;(n=document.getElementById("select-dialog-container"))===null||n===void 0||n.remove()}static open(n){let e=document.createElement("div");e.id="select-dialog-container",e.style.top=e.getBoundingClientRect().top.toString(),e.innerHTML=n,(0,P.replaceScripts)(e),document.body.appendChild(e);let o=()=>{t.close(),document.removeEventListener("keydown",o)};document.addEventListener("keydown",o)}};p.SelectDialog=v;v.state={}});var C=a(l=>{"use strict";Object.defineProperty(l,"__esModule",{value:!0});l.replaceScripts=I;l.getLastListNumberBeforeCursor=k;l.insertStringInInputAtCursor=B;l.fetchLink=x;var u=S();function I(t){var n;if(t.tagName==="SCRIPT"){let e=document.createElement("script");e.text=t.innerHTML;for(let o=0;o<t.attributes.length;o++)e.setAttribute(t.attributes[o].name,t.attributes[o].value);(n=t.parentNode)===null||n===void 0||n.replaceChild(e,t)}for(let e=0;e<t.children.length;e++){let o=t.children.item(e);o&&I(o)}}function k(t){let n=/(\n(\d+)|^(\d+))\./g,e=[...t.value.slice(0,t.selectionStart).matchAll(n)];return e.length>0?e[e.length-1][1]:null}function B(t,n){let e=t.selectionStart,o=e+n.length;t.value=t.value.slice(0,e)+n+t.value.slice(t.selectionEnd),t.selectionStart=t.selectionEnd=o}function x(t){let n=t.selectionStart;if(t.value.length===0||t.value[n-1]!=="]")return;let o="",i=n-2;for(;i-- >0&&t.value[i]!=="[";)o+=t.value[i];let r=new URLSearchParams({query:o.split("").reverse().join("")});fetch(`${window.location.origin}/recipe/link?`+r.toString()).then(c=>c.text()).then(c=>{u.SelectDialog.state.target=t,u.SelectDialog.state.cursorPos=n,u.SelectDialog.state.substitutionStart=i;try{let s=JSON.parse(c);u.SelectDialog.injectLinkIntoTextarea(s.title,s.id)}catch(s){u.SelectDialog.open(c)}}).catch(console.error)}});var b=a(h=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0});h.attachTextAreaEventListeners=O;h.handleCopyUrlToClipboardButton=M;var y=E(),d=C();function O(){let t=c=>{c.key==="Enter"&&c.target&&(0,d.insertStringInInputAtCursor)(c.target,"- ")},n=c=>{c.target&&(0,d.fetchLink)(c.target)},e=c=>{if(c.key==="Enter"&&c.target){let s=(0,d.getLastListNumberBeforeCursor)(c.target);s&&(0,d.insertStringInInputAtCursor)(c.target,`${parseInt(s)+1}. `)}},o=c=>{c.target&&(0,d.fetchLink)(c.target)},i=document.getElementById("ingredients");i==null||i.addEventListener("keyup",t),i==null||i.addEventListener("input",n);let r=document.getElementById("instructions");r==null||r.addEventListener("keyup",e),r==null||r.addEventListener("input",o)}function M(){let t=window.location.href;navigator.clipboard.writeText(t).then(()=>{(0,y.notify)("Link kopiert","success")}).catch(()=>{(0,y.notify)("Kopieren fehlgeschlagen","error")})}});var L=a(m=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});m.LocalStorageUtil=void 0;var f=class t{static saveForm(){let n=t.INPUTS.reduce((e,o)=>{var i;let r=document.getElementById(o);return e[o]=(i=r==null?void 0:r.value)!==null&&i!==void 0?i:"",e},{});localStorage.setItem(t.RECIPE_NEW_KEY,JSON.stringify(n))}static loadForm(){let n=localStorage.getItem(t.RECIPE_NEW_KEY);if(!n)return;let e=JSON.parse(n);e&&t.INPUTS.forEach(o=>{var i;let r=document.getElementById(o);r&&(r.value=(i=e[o])!==null&&i!==void 0?i:"")})}static deleteForm(){localStorage.setItem(t.RECIPE_NEW_KEY,"")}};m.LocalStorageUtil=f;f.INPUTS=["title","description","duration","author","source","tags","ingredients","instructions"];f.RECIPE_NEW_KEY="recipe_new"});var j=a(_=>{Object.defineProperty(_,"__esModule",{value:!0});var w=b(),A=L(),D=E(),U=S();function q(){(0,D.attachMutationObserverToNotificationContainer)(),window.LocalStorageUtil=A.LocalStorageUtil,window.SelectDialog=U.SelectDialog,window.attachTextAreaEventListeners=w.attachTextAreaEventListeners,window.handleCopyUrlToClipboardButton=w.handleCopyUrlToClipboardButton}q()});j();})();
