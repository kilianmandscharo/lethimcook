"use strict";(()=>{var l=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var E=l(v=>{"use strict";Object.defineProperty(v,"__esModule",{value:!0});v.attachMutationObserverToNotificationContainer=P;v.notify=T;function P(){let t=document.getElementById("notification-container");if(!t)return;new MutationObserver((i,o)=>{for(let n of i)n.type==="childList"&&n.addedNodes.forEach(r=>{setTimeout(()=>{t.removeChild(r)},3e3)})}).observe(t,{childList:!0})}function T(t,e){let i=document.getElementById("notification-container");if(!i)return;let n=document.querySelectorAll(".notification").length,r=document.createElement("div");r.id=`notification-${n}`,r.className=e==="success"?"notification notification-success":"notification notification-danger";let c=document.createElement("div");c.className=e==="success"?"fa-solid fa-circle-info":"fa-regular fa-circle-exclamation";let s=document.createElement("p");s.className="notification-text",s.innerText=t,r.appendChild(c),r.appendChild(s),i.appendChild(r)}});var S=l(p=>{"use strict";Object.defineProperty(p,"__esModule",{value:!0});p.SelectDialog=void 0;var k=C(),g=class t{static injectLinkIntoTextarea(e,i){let{cursorPos:o,target:n,substitutionStart:r}=t.state;if(o===void 0||n===void 0||r===void 0)return;let c=`[${e}](${window.location.origin}/recipe/${i})`,s=o+c.length;n.value=n.value.slice(0,r)+c+n.value.slice(t.state.cursorPos),n.selectionStart=n.selectionEnd=s-(o-r),t.state={}}static close(){var e;(e=document.getElementById("select-dialog-container"))===null||e===void 0||e.remove()}static open(e){let i=document.createElement("div");i.innerHTML=e,(0,k.replaceScripts)(i),document.body.appendChild(i)}};p.SelectDialog=g;g.state={}});var C=l(a=>{"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.replaceScripts=b;a.getLastListNumberBeforeCursor=B;a.insertStringInInputAtCursor=x;a.extractContentBetweenBrackets=I;a.fetchLink=O;var u=S();function b(t){var e;if(t.tagName==="SCRIPT"){let i=document.createElement("script");i.text=t.innerHTML;for(let o=0;o<t.attributes.length;o++)i.setAttribute(t.attributes[o].name,t.attributes[o].value);(e=t.parentNode)===null||e===void 0||e.replaceChild(i,t)}for(let i=0;i<t.children.length;i++){let o=t.children.item(i);o&&b(o)}}function B(t){let e=/(\n(\d+)|^(\d+))\./g,i=[...t.value.slice(0,t.selectionStart).matchAll(e)];return i.length>0?i[i.length-1][1]:null}function x(t,e){let i=t.selectionStart,o=i+e.length;t.value=t.value.slice(0,i)+e+t.value.slice(t.selectionEnd),t.selectionStart=t.selectionEnd=o}function I(t){if(t.value.length===0)return null;let e=t.selectionStart;if(t.value[e-1]!=="]")return null;let o="",n=e-2,r=!1;for(;n>0;){if(t.value[n]==="!"&&t.value[n-1]==="["){r=!0;break}o+=t.value[n],n--}return r?{query:o.split("").reverse().join(""),substitutionStart:n-1,substitutionEnd:e}:null}function O(t){let e=I(t);if(!e)return;let i=new URLSearchParams({query:e.query});fetch(`${window.location.origin}/recipe/link?`+i.toString()).then(o=>o.text()).then(o=>{u.SelectDialog.state.target=t,u.SelectDialog.state.cursorPos=e.substitutionEnd,u.SelectDialog.state.substitutionStart=e.substitutionStart;try{let n=JSON.parse(o);u.SelectDialog.injectLinkIntoTextarea(n.title,n.id)}catch(n){u.SelectDialog.open(o)}}).catch(console.error)}});var L=l(h=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0});h.attachTextAreaEventListeners=q;h.handleCopyUrlToClipboardButton=M;var y=E(),d=C();function q(){let t=c=>{c.key==="Enter"&&c.target&&(0,d.insertStringInInputAtCursor)(c.target,"- ")},e=c=>{c.target&&(0,d.fetchLink)(c.target)},i=c=>{if(c.key==="Enter"&&c.target){let s=(0,d.getLastListNumberBeforeCursor)(c.target);s&&(0,d.insertStringInInputAtCursor)(c.target,`${parseInt(s)+1}. `)}},o=c=>{c.target&&(0,d.fetchLink)(c.target)},n=document.getElementById("ingredients");n==null||n.addEventListener("keyup",t),n==null||n.addEventListener("input",e);let r=document.getElementById("instructions");r==null||r.addEventListener("keyup",i),r==null||r.addEventListener("input",o)}function M(){let t=window.location.href;navigator.clipboard.writeText(t).then(()=>{(0,y.notify)("Link kopiert","success")}).catch(()=>{(0,y.notify)("Kopieren fehlgeschlagen","error")})}});var _=l(m=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});m.LocalStorageUtil=void 0;var f=class t{static saveForm(){let e=t.INPUTS.reduce((i,o)=>{var n;let r=document.getElementById(o);return i[o]=(n=r==null?void 0:r.value)!==null&&n!==void 0?n:"",i},{});localStorage.setItem(t.RECIPE_NEW_KEY,JSON.stringify(e))}static loadForm(){let e=localStorage.getItem(t.RECIPE_NEW_KEY);if(!e)return;let i=JSON.parse(e);i&&t.INPUTS.forEach(o=>{var n;let r=document.getElementById(o);r&&(r.value=(n=i[o])!==null&&n!==void 0?n:"")})}static deleteForm(){localStorage.setItem(t.RECIPE_NEW_KEY,"")}};m.LocalStorageUtil=f;f.INPUTS=["title","description","duration","author","source","tags","ingredients","instructions"];f.RECIPE_NEW_KEY="recipe_new"});var K=l(N=>{Object.defineProperty(N,"__esModule",{value:!0});var w=L(),A=_(),D=E(),U=S();function j(){(0,D.attachMutationObserverToNotificationContainer)(),window.LocalStorageUtil=A.LocalStorageUtil,window.SelectDialog=U.SelectDialog,window.attachTextAreaEventListeners=w.attachTextAreaEventListeners,window.handleCopyUrlToClipboardButton=w.handleCopyUrlToClipboardButton}j()});K();})();
