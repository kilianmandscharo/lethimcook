"use strict";(()=>{var l=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var E=l(g=>{"use strict";Object.defineProperty(g,"__esModule",{value:!0});g.attachMutationObserverToNotificationContainer=P;g.notify=T;function P(){let t=document.getElementById("notification-container");if(!t)return;new MutationObserver((n,o)=>{for(let i of n)i.type==="childList"&&i.addedNodes.forEach(r=>{setTimeout(()=>{t.removeChild(r)},3e3)})}).observe(t,{childList:!0})}function T(t,e){let n=document.getElementById("notification-container");if(!n)return;let i=document.querySelectorAll(".notification").length,r=document.createElement("div");r.id=`notification-${i}`,r.className=e==="success"?"notification notification-success":"notification notification-danger";let c=document.createElement("div");c.className=e==="success"?"fa-solid fa-circle-info":"fa-regular fa-circle-exclamation";let s=document.createElement("p");s.className="notification-text",s.innerText=t,r.appendChild(c),r.appendChild(s),n.appendChild(r)}});var S=l(p=>{"use strict";Object.defineProperty(p,"__esModule",{value:!0});p.SelectDialog=void 0;var k=C(),v=class t{static injectLinkIntoTextarea(e,n){let{cursorPos:o,target:i,substitutionStart:r}=t.state;if(o===void 0||i===void 0||r===void 0)return;let c=`[${e}](${window.location.origin}/recipe/${n})`,s=o+c.length;i.value=i.value.slice(0,r)+c+i.value.slice(t.state.cursorPos),i.selectionStart=i.selectionEnd=s-(o-r),t.state={}}static close(){var e;(e=document.getElementById("select-dialog-container"))===null||e===void 0||e.remove()}static open(e){let n=document.createElement("div");n.id="select-dialog-container",n.style.top=n.getBoundingClientRect().top.toString(),n.innerHTML=e,(0,k.replaceScripts)(n),document.body.appendChild(n);let o=()=>{t.close(),document.removeEventListener("keydown",o)};document.addEventListener("keydown",o)}};p.SelectDialog=v;v.state={}});var C=l(a=>{"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.replaceScripts=y;a.getLastListNumberBeforeCursor=B;a.insertStringInInputAtCursor=x;a.extractContentBetweenBrackets=b;a.fetchLink=O;var u=S();function y(t){var e;if(t.tagName==="SCRIPT"){let n=document.createElement("script");n.text=t.innerHTML;for(let o=0;o<t.attributes.length;o++)n.setAttribute(t.attributes[o].name,t.attributes[o].value);(e=t.parentNode)===null||e===void 0||e.replaceChild(n,t)}for(let n=0;n<t.children.length;n++){let o=t.children.item(n);o&&y(o)}}function B(t){let e=/(\n(\d+)|^(\d+))\./g,n=[...t.value.slice(0,t.selectionStart).matchAll(e)];return n.length>0?n[n.length-1][1]:null}function x(t,e){let n=t.selectionStart,o=n+e.length;t.value=t.value.slice(0,n)+e+t.value.slice(t.selectionEnd),t.selectionStart=t.selectionEnd=o}function b(t){if(t.value.length===0)return null;let e=t.selectionStart;if(t.value[e-1]!=="]")return null;let o="",i=e-2,r=!1;for(;i>0;){if(t.value[i]==="!"&&t.value[i-1]==="["){r=!0;break}o+=t.value[i],i--}return r?{query:o.split("").reverse().join(""),substitutionStart:i-1,substitutionEnd:e}:null}function O(t){let e=b(t);if(!e)return;let n=new URLSearchParams({query:e.query});fetch(`${window.location.origin}/recipe/link?`+n.toString()).then(o=>o.text()).then(o=>{u.SelectDialog.state.target=t,u.SelectDialog.state.cursorPos=e.substitutionEnd,u.SelectDialog.state.substitutionStart=e.substitutionStart;try{let i=JSON.parse(o);u.SelectDialog.injectLinkIntoTextarea(i.title,i.id)}catch(i){u.SelectDialog.open(o)}}).catch(console.error)}});var L=l(h=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0});h.attachTextAreaEventListeners=q;h.handleCopyUrlToClipboardButton=D;var I=E(),d=C();function q(){let t=c=>{c.key==="Enter"&&c.target&&(0,d.insertStringInInputAtCursor)(c.target,"- ")},e=c=>{c.target&&(0,d.fetchLink)(c.target)},n=c=>{if(c.key==="Enter"&&c.target){let s=(0,d.getLastListNumberBeforeCursor)(c.target);s&&(0,d.insertStringInInputAtCursor)(c.target,`${parseInt(s)+1}. `)}},o=c=>{c.target&&(0,d.fetchLink)(c.target)},i=document.getElementById("ingredients");i==null||i.addEventListener("keyup",t),i==null||i.addEventListener("input",e);let r=document.getElementById("instructions");r==null||r.addEventListener("keyup",n),r==null||r.addEventListener("input",o)}function D(){let t=window.location.href;navigator.clipboard.writeText(t).then(()=>{(0,I.notify)("Link kopiert","success")}).catch(()=>{(0,I.notify)("Kopieren fehlgeschlagen","error")})}});var w=l(m=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});m.LocalStorageUtil=void 0;var f=class t{static saveForm(){let e=t.INPUTS.reduce((n,o)=>{var i;let r=document.getElementById(o);return n[o]=(i=r==null?void 0:r.value)!==null&&i!==void 0?i:"",n},{});localStorage.setItem(t.RECIPE_NEW_KEY,JSON.stringify(e))}static loadForm(){let e=localStorage.getItem(t.RECIPE_NEW_KEY);if(!e)return;let n=JSON.parse(e);n&&t.INPUTS.forEach(o=>{var i;let r=document.getElementById(o);r&&(r.value=(i=n[o])!==null&&i!==void 0?i:"")})}static deleteForm(){localStorage.setItem(t.RECIPE_NEW_KEY,"")}};m.LocalStorageUtil=f;f.INPUTS=["title","description","duration","author","source","tags","ingredients","instructions"];f.RECIPE_NEW_KEY="recipe_new"});var R=l(N=>{Object.defineProperty(N,"__esModule",{value:!0});var _=L(),M=w(),A=E(),U=S();function j(){(0,A.attachMutationObserverToNotificationContainer)(),window.LocalStorageUtil=M.LocalStorageUtil,window.SelectDialog=U.SelectDialog,window.attachTextAreaEventListeners=_.attachTextAreaEventListeners,window.handleCopyUrlToClipboardButton=_.handleCopyUrlToClipboardButton}j()});R();})();
